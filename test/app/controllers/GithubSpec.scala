package app.controllers

import org.specs2.mutable._
import org.specs2.specification.Example
import org.specs2.time.NoTimeConversions
import play.api.mvc.Result
import play.api.test._
import play.api.test.Helpers._
import play.api.libs.json.Json
import controllers.GithubHook
import akka.actor._
import akka.testkit._
import akka.util.duration._
import hub.HubActor
import org.specs2.matcher.Matcher

/* A tiny class that can be used as a Specs2 'context'. */
abstract class AkkaTestkitSpecs2Support extends TestKit(ActorSystem()) 
                                           with After 
                                           with ImplicitSender {
  // make sure we shut down the actor system after all tests have run
  def after = system.shutdown()
}

class GithubSpec extends TestKit(ActorSystem()) with Specification with NoTimeConversions {
  sequential
  import GithubHook._

  "Github JSON parsing" should {
    def jsonParsingExample(exampleName: String, eventName: String, eventPayload: String, matcher: Matcher[Either[String,Option[GithubEvent]]]): Example = {
      exampleName in {
        refineGithubEvent(GithubEventRaw(eventName, Json.parse(eventPayload))).left.map(_.getStackTraceString) must matcher
      }
    }
    jsonParsingExample(
      "parse pull request opened event",
      "pull_request",
      """{ "action": "opened", "number": 942, "pull_request": { "_links": { "comments": { "href": "https://api.github.com/repos/akka/akka/issues/942/comments" }, "html": { "href": "https://github.com/akka/akka/pull/942" }, "issue": { "href": "https://api.github.com/repos/akka/akka/issues/942" }, "review_comments": { "href": "https://api.github.com/repos/akka/akka/pulls/942/comments" }, "self": { "href": "https://api.github.com/repos/akka/akka/pulls/942" } }, "additions": 39, "assignee": null, "base": { "label": "akka:release-2.0", "ref": "release-2.0", "repo": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T15:18:25Z", "size": 15616, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-13T15:18:25Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1418, "watchers_count": 1418 }, "sha": "d04a0bd586e732bb55d4bbdac2e76cd92a6910cf", "user": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" } }, "body": "...to make sure that it also works over remoting\r\n\r\n\r\nWARNING: I am not convinced this is the best solution, imo it's better to make sure that nulls can travel across the wire, it will also be a less intrusive change, and a more performant change. But it's ultimately up to the Akka team", "changed_files": 2, "closed_at": null, "comments": 0, "comments_url": "https://api.github.com/repos/akka/akka/issues/942/comments", "commits": 1, "commits_url": "https://github.com/akka/akka/pull/942/commits", "created_at": "2012-12-13T15:21:41Z", "deletions": 14, "diff_url": "https://github.com/akka/akka/pull/942.diff", "head": { "label": "akka:wip-2799-null-replies-typed-actor-\u221a", "ref": "wip-2799-null-replies-typed-actor-\u221a", "repo": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T15:18:25Z", "size": 15616, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-13T15:18:25Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1418, "watchers_count": 1418 }, "sha": "3ba0d709590cc74855cf38565e63cf104dacd8be", "user": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" } }, "html_url": "https://github.com/akka/akka/pull/942", "id": 3356553, "issue_url": "https://github.com/akka/akka/issues/942", "merge_commit_sha": "", "mergeable": null, "mergeable_state": "unknown", "merged": false, "merged_at": null, "merged_by": null, "milestone": null, "number": 942, "patch_url": "https://github.com/akka/akka/pull/942.patch", "review_comment_url": "/repos/akka/akka/pulls/comments/{number}", "review_comments": 0, "review_comments_url": "https://github.com/akka/akka/pull/942/comments", "state": "open", "title": " #2799 - Making sure that 'null' is boxed when going across TypedActors ...", "updated_at": "2012-12-13T15:21:41Z", "url": "https://api.github.com/repos/akka/akka/pulls/942", "user": { "avatar_url": "https://secure.gravatar.com/avatar/4f674b2e79f1663864ff78e07ce4c8a8?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/viktorklang/events{/privacy}", "followers_url": "https://api.github.com/users/viktorklang/followers", "following_url": "https://api.github.com/users/viktorklang/following", "gists_url": "https://api.github.com/users/viktorklang/gists{/gist_id}", "gravatar_id": "4f674b2e79f1663864ff78e07ce4c8a8", "id": 10871, "login": "viktorklang", "organizations_url": "https://api.github.com/users/viktorklang/orgs", "received_events_url": "https://api.github.com/users/viktorklang/received_events", "repos_url": "https://api.github.com/users/viktorklang/repos", "starred_url": "https://api.github.com/users/viktorklang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viktorklang/subscriptions", "type": "User", "url": "https://api.github.com/users/viktorklang" } }, "repository": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T15:18:25Z", "size": 15616, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-13T15:18:25Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1418, "watchers_count": 1418 }, "sender": { "avatar_url": "https://secure.gravatar.com/avatar/4f674b2e79f1663864ff78e07ce4c8a8?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/viktorklang/events{/privacy}", "followers_url": "https://api.github.com/users/viktorklang/followers", "following_url": "https://api.github.com/users/viktorklang/following", "gists_url": "https://api.github.com/users/viktorklang/gists{/gist_id}", "gravatar_id": "4f674b2e79f1663864ff78e07ce4c8a8", "id": 10871, "login": "viktorklang", "organizations_url": "https://api.github.com/users/viktorklang/orgs", "received_events_url": "https://api.github.com/users/viktorklang/received_events", "repos_url": "https://api.github.com/users/viktorklang/repos", "starred_url": "https://api.github.com/users/viktorklang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viktorklang/subscriptions", "type": "User", "url": "https://api.github.com/users/viktorklang" } }""",
      equalTo(Right(Some(PullRequestEvent("opened", "942", "akka", "akka")))))
    jsonParsingExample(
      "parse pull request synchronize event",
      "pull_request",
      """{ "action": "synchronize", "number": 941, "pull_request": { "_links": { "comments": { "href": "https://api.github.com/repos/akka/akka/issues/941/comments" }, "html": { "href": "https://github.com/akka/akka/pull/941" }, "issue": { "href": "https://api.github.com/repos/akka/akka/issues/941" }, "review_comments": { "href": "https://api.github.com/repos/akka/akka/pulls/941/comments" }, "self": { "href": "https://api.github.com/repos/akka/akka/pulls/941" } }, "additions": 327, "assignee": null, "base": { "label": "akka:release-2.1", "ref": "release-2.1", "repo": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T21:19:21Z", "size": 15624, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-13T21:19:22Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1418, "watchers_count": 1418 }, "sha": "f7f14d135fef62bb0821bf7fa50a68f4cd5db94b", "user": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" } }, "body": "* Cluster `MemberEvent`s shold only be published on convergence\r\n* Also removed `isConvergence` from JMX bean and documentation which was done as part of a larger change in master", "changed_files": 25, "closed_at": null, "comments": 5, "comments_url": "https://api.github.com/repos/akka/akka/issues/941/comments", "commits": 9, "commits_url": "https://github.com/akka/akka/pull/941/commits", "created_at": "2012-12-12T13:43:49Z", "deletions": 312, "diff_url": "https://github.com/akka/akka/pull/941.diff", "head": { "label": "akka:wip-2692-2.1-cluster-membership-events-ban", "ref": "wip-2692-2.1-cluster-membership-events-ban", "repo": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T21:19:21Z", "size": 15624, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-13T21:19:22Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1418, "watchers_count": 1418 }, "sha": "7ad91695a0ea6f0ace69b41e91d63828acccf99b", "user": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" } }, "html_url": "https://github.com/akka/akka/pull/941", "id": 3337196, "issue_url": "https://github.com/akka/akka/issues/941", "merge_commit_sha": "fac57520687dfb66e9c29de8982e86dc2feb54d0", "mergeable": null, "mergeable_state": "unknown", "merged": false, "merged_at": null, "merged_by": null, "milestone": null, "number": 941, "patch_url": "https://github.com/akka/akka/pull/941.patch", "review_comment_url": "/repos/akka/akka/pulls/comments/{number}", "review_comments": 5, "review_comments_url": "https://github.com/akka/akka/pull/941/comments", "state": "open", "title": "2.1 Backport: Cluster Membership Events, see #2692", "updated_at": "2012-12-13T21:19:23Z", "url": "https://api.github.com/repos/akka/akka/pulls/941", "user": { "avatar_url": "https://secure.gravatar.com/avatar/96b5aad495e0efd9fc098b9b3d421623?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/bantonsson/events{/privacy}", "followers_url": "https://api.github.com/users/bantonsson/followers", "following_url": "https://api.github.com/users/bantonsson/following", "gists_url": "https://api.github.com/users/bantonsson/gists{/gist_id}", "gravatar_id": "96b5aad495e0efd9fc098b9b3d421623", "id": 805830, "login": "bantonsson", "organizations_url": "https://api.github.com/users/bantonsson/orgs", "received_events_url": "https://api.github.com/users/bantonsson/received_events", "repos_url": "https://api.github.com/users/bantonsson/repos", "starred_url": "https://api.github.com/users/bantonsson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bantonsson/subscriptions", "type": "User", "url": "https://api.github.com/users/bantonsson" } }, "repository": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T21:19:21Z", "size": 15624, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-13T21:19:22Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1418, "watchers_count": 1418 }, "sender": { "avatar_url": "https://secure.gravatar.com/avatar/96b5aad495e0efd9fc098b9b3d421623?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/bantonsson/events{/privacy}", "followers_url": "https://api.github.com/users/bantonsson/followers", "following_url": "https://api.github.com/users/bantonsson/following", "gists_url": "https://api.github.com/users/bantonsson/gists{/gist_id}", "gravatar_id": "96b5aad495e0efd9fc098b9b3d421623", "id": 805830, "login": "bantonsson", "organizations_url": "https://api.github.com/users/bantonsson/orgs", "received_events_url": "https://api.github.com/users/bantonsson/received_events", "repos_url": "https://api.github.com/users/bantonsson/repos", "starred_url": "https://api.github.com/users/bantonsson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bantonsson/subscriptions", "type": "User", "url": "https://api.github.com/users/bantonsson" } }""",
      equalTo(Right(Some(PullRequestEvent("synchronize", "941", "akka", "akka")))))
    jsonParsingExample(
      "parse pull request closed event",
      "pull_request",
      """{ "action": "closed", "number": 589, "pull_request": { "_links": { "comments": { "href": "https://api.github.com/repos/akka/akka/issues/589/comments" }, "html": { "href": "https://github.com/akka/akka/pull/589" }, "issue": { "href": "https://api.github.com/repos/akka/akka/issues/589" }, "review_comments": { "href": "https://api.github.com/repos/akka/akka/pulls/589/comments" }, "self": { "href": "https://api.github.com/repos/akka/akka/pulls/589" } }, "additions": 412, "assignee": null, "base": { "label": "akka:master", "ref": "master", "repo": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 272, "forks_count": 272, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 9, "open_issues_count": 9, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-11T10:10:19Z", "size": 15648, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-11T10:10:20Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1416, "watchers_count": 1416 }, "sha": "e53370f173c82a2e206921d4dcc30f6b68ac7332", "user": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" } }, "body": "Covering akka-actor and akka-osgi. Testing ActorSystemActivator inside Apache Felix.", "changed_files": 6, "closed_at": "2012-12-11T12:53:36Z", "comments": 29, "comments_url": "https://api.github.com/repos/akka/akka/issues/589/comments", "commits": 5, "commits_url": "https://github.com/akka/akka/pull/589/commits", "created_at": "2012-08-02T10:40:27Z", "deletions": 1, "diff_url": "https://github.com/akka/akka/pull/589.diff", "head": { "label": "muuki88:master", "ref": "master", "repo": { "archive_url": "https://api.github.com/repos/muuki88/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/muuki88/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/muuki88/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/muuki88/akka/branches{/branch}", "clone_url": "https://github.com/muuki88/akka.git", "collaborators_url": "https://api.github.com/repos/muuki88/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/muuki88/akka/comments{/number}", "commits_url": "https://api.github.com/repos/muuki88/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/muuki88/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/muuki88/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/muuki88/akka/contributors", "created_at": "2012-08-02T08:51:15Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/muuki88/akka/downloads", "events_url": "https://api.github.com/repos/muuki88/akka/events", "fork": true, "forks": 0, "forks_count": 0, "forks_url": "https://api.github.com/repos/muuki88/akka/forks", "full_name": "muuki88/akka", "git_commits_url": "https://api.github.com/repos/muuki88/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/muuki88/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/muuki88/akka/git/tags{/sha}", "git_url": "git://github.com/muuki88/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/muuki88/akka/hooks", "html_url": "https://github.com/muuki88/akka", "id": 5270292, "issue_comment_url": "https://api.github.com/repos/muuki88/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/muuki88/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/muuki88/akka/issues{/number}", "keys_url": "https://api.github.com/repos/muuki88/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/muuki88/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/muuki88/akka/languages", "merges_url": "https://api.github.com/repos/muuki88/akka/merges", "milestones_url": "https://api.github.com/repos/muuki88/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/muuki88/akka/notifications{?since,all,participating}", "open_issues": 0, "open_issues_count": 0, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/58d2d521a45ae75ddf084dc530b647d4?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/muuki88/events{/privacy}", "followers_url": "https://api.github.com/users/muuki88/followers", "following_url": "https://api.github.com/users/muuki88/following", "gists_url": "https://api.github.com/users/muuki88/gists{/gist_id}", "gravatar_id": "58d2d521a45ae75ddf084dc530b647d4", "id": 647727, "login": "muuki88", "organizations_url": "https://api.github.com/users/muuki88/orgs", "received_events_url": "https://api.github.com/users/muuki88/received_events", "repos_url": "https://api.github.com/users/muuki88/repos", "starred_url": "https://api.github.com/users/muuki88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/muuki88/subscriptions", "type": "User", "url": "https://api.github.com/users/muuki88" }, "private": false, "pulls_url": "https://api.github.com/repos/muuki88/akka/pulls{/number}", "pushed_at": "2012-11-03T17:03:36Z", "size": 148, "ssh_url": "git@github.com:muuki88/akka.git", "stargazers_url": "https://api.github.com/repos/muuki88/akka/stargazers", "statuses_url": "https://api.github.com/repos/muuki88/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/muuki88/akka/subscribers", "subscription_url": "https://api.github.com/repos/muuki88/akka/subscription", "svn_url": "https://github.com/muuki88/akka", "tags_url": "https://api.github.com/repos/muuki88/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/muuki88/akka/teams", "trees_url": "https://api.github.com/repos/muuki88/akka/git/trees{/sha}", "updated_at": "2012-11-03T17:03:37Z", "url": "https://api.github.com/repos/muuki88/akka", "watchers": 1, "watchers_count": 1 }, "sha": "bdc0229b608c30e1a3616d68ce209c0a672afee9", "user": { "avatar_url": "https://secure.gravatar.com/avatar/58d2d521a45ae75ddf084dc530b647d4?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/muuki88/events{/privacy}", "followers_url": "https://api.github.com/users/muuki88/followers", "following_url": "https://api.github.com/users/muuki88/following", "gists_url": "https://api.github.com/users/muuki88/gists{/gist_id}", "gravatar_id": "58d2d521a45ae75ddf084dc530b647d4", "id": 647727, "login": "muuki88", "organizations_url": "https://api.github.com/users/muuki88/orgs", "received_events_url": "https://api.github.com/users/muuki88/received_events", "repos_url": "https://api.github.com/users/muuki88/repos", "starred_url": "https://api.github.com/users/muuki88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/muuki88/subscriptions", "type": "User", "url": "https://api.github.com/users/muuki88" } }, "html_url": "https://github.com/akka/akka/pull/589", "id": 1954873, "issue_url": "https://github.com/akka/akka/issues/589", "merge_commit_sha": "30eb32d89478c475662046af8a746c82ae182f58", "mergeable": true, "mergeable_state": "clean", "merged": false, "merged_at": null, "merged_by": null, "milestone": null, "number": 589, "patch_url": "https://github.com/akka/akka/pull/589.patch", "review_comment_url": "/repos/akka/akka/pulls/comments/{number}", "review_comments": 0, "review_comments_url": "https://github.com/akka/akka/pull/589/comments", "state": "closed", "title": "OSGi Test", "updated_at": "2012-12-11T12:53:36Z", "url": "https://api.github.com/repos/akka/akka/pulls/589", "user": { "avatar_url": "https://secure.gravatar.com/avatar/58d2d521a45ae75ddf084dc530b647d4?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/muuki88/events{/privacy}", "followers_url": "https://api.github.com/users/muuki88/followers", "following_url": "https://api.github.com/users/muuki88/following", "gists_url": "https://api.github.com/users/muuki88/gists{/gist_id}", "gravatar_id": "58d2d521a45ae75ddf084dc530b647d4", "id": 647727, "login": "muuki88", "organizations_url": "https://api.github.com/users/muuki88/orgs", "received_events_url": "https://api.github.com/users/muuki88/received_events", "repos_url": "https://api.github.com/users/muuki88/repos", "starred_url": "https://api.github.com/users/muuki88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/muuki88/subscriptions", "type": "User", "url": "https://api.github.com/users/muuki88" } }, "repository": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 272, "forks_count": 272, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 9, "open_issues_count": 9, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-11T10:10:19Z", "size": 15648, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-11T10:10:20Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1416, "watchers_count": 1416 }, "sender": { "avatar_url": "https://secure.gravatar.com/avatar/262b1ab25e66b1e15a48fa3f68703aad?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/rkuhn/events{/privacy}", "followers_url": "https://api.github.com/users/rkuhn/followers", "following_url": "https://api.github.com/users/rkuhn/following", "gists_url": "https://api.github.com/users/rkuhn/gists{/gist_id}", "gravatar_id": "262b1ab25e66b1e15a48fa3f68703aad", "id": 470469, "login": "rkuhn", "organizations_url": "https://api.github.com/users/rkuhn/orgs", "received_events_url": "https://api.github.com/users/rkuhn/received_events", "repos_url": "https://api.github.com/users/rkuhn/repos", "starred_url": "https://api.github.com/users/rkuhn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkuhn/subscriptions", "type": "User", "url": "https://api.github.com/users/rkuhn" } }""",
      equalTo(Right(Some(PullRequestEvent("closed", "589", "akka", "akka")))))
    jsonParsingExample(
      "parse pull request issue comment created event containing PLS REBUILD ALL",
      "issue_comment",
      """{ "action": "created", "comment": { "body": "PLS REBUILD ALL\r\n", "created_at": "2012-12-14T10:43:53Z", "id": 11372024, "issue_url": "https://api.github.com/repos/akka/akka/issues/9216019", "updated_at": "2012-12-14T10:43:53Z", "url": "https://api.github.com/repos/akka/akka/issues/comments/11372024", "user": { "avatar_url": "https://secure.gravatar.com/avatar/96b5aad495e0efd9fc098b9b3d421623?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/bantonsson/events{/privacy}", "followers_url": "https://api.github.com/users/bantonsson/followers", "following_url": "https://api.github.com/users/bantonsson/following", "gists_url": "https://api.github.com/users/bantonsson/gists{/gist_id}", "gravatar_id": "96b5aad495e0efd9fc098b9b3d421623", "id": 805830, "login": "bantonsson", "organizations_url": "https://api.github.com/users/bantonsson/orgs", "received_events_url": "https://api.github.com/users/bantonsson/received_events", "repos_url": "https://api.github.com/users/bantonsson/repos", "starred_url": "https://api.github.com/users/bantonsson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bantonsson/subscriptions", "type": "User", "url": "https://api.github.com/users/bantonsson" } }, "issue": { "assignee": null, "body": "* Cluster `MemberEvent`s shold only be published on convergence\r\n* Also removed `isConvergence` from JMX bean and documentation which was done as part of a larger change in master", "closed_at": null, "comments": 11, "comments_url": "https://api.github.com/repos/akka/akka/issues/941/comments", "created_at": "2012-12-12T13:43:49Z", "events_url": "https://api.github.com/repos/akka/akka/issues/941/events", "html_url": "https://github.com/akka/akka/issues/941", "id": 9216019, "labels": [], "labels_url": "https://api.github.com/repos/akka/akka/issues/941/labels{/name}", "milestone": null, "number": 941, "pull_request": { "diff_url": "https://github.com/akka/akka/pull/941.diff", "html_url": "https://github.com/akka/akka/pull/941", "patch_url": "https://github.com/akka/akka/pull/941.patch" }, "state": "open", "title": "2.1 Backport: Cluster Membership Events, see #2692", "updated_at": "2012-12-14T10:43:53Z", "url": "https://api.github.com/repos/akka/akka/issues/941", "user": { "avatar_url": "https://secure.gravatar.com/avatar/96b5aad495e0efd9fc098b9b3d421623?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/bantonsson/events{/privacy}", "followers_url": "https://api.github.com/users/bantonsson/followers", "following_url": "https://api.github.com/users/bantonsson/following", "gists_url": "https://api.github.com/users/bantonsson/gists{/gist_id}", "gravatar_id": "96b5aad495e0efd9fc098b9b3d421623", "id": 805830, "login": "bantonsson", "organizations_url": "https://api.github.com/users/bantonsson/orgs", "received_events_url": "https://api.github.com/users/bantonsson/received_events", "repos_url": "https://api.github.com/users/bantonsson/repos", "starred_url": "https://api.github.com/users/bantonsson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bantonsson/subscriptions", "type": "User", "url": "https://api.github.com/users/bantonsson" } }, "repository": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 10, "open_issues_count": 10, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-14T10:39:50Z", "size": 15620, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-14T10:39:50Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1420, "watchers_count": 1420 }, "sender": { "avatar_url": "https://secure.gravatar.com/avatar/96b5aad495e0efd9fc098b9b3d421623?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/bantonsson/events{/privacy}", "followers_url": "https://api.github.com/users/bantonsson/followers", "following_url": "https://api.github.com/users/bantonsson/following", "gists_url": "https://api.github.com/users/bantonsson/gists{/gist_id}", "gravatar_id": "96b5aad495e0efd9fc098b9b3d421623", "id": 805830, "login": "bantonsson", "organizations_url": "https://api.github.com/users/bantonsson/orgs", "received_events_url": "https://api.github.com/users/bantonsson/received_events", "repos_url": "https://api.github.com/users/bantonsson/repos", "starred_url": "https://api.github.com/users/bantonsson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bantonsson/subscriptions", "type": "User", "url": "https://api.github.com/users/bantonsson" } }""",
      equalTo(Right(Some(IssueCommentEvent("created", "941", true, "PLS REBUILD ALL\r\n", "akka", "akka")))))
    jsonParsingExample(
      "parse pull request issue comment created event containing general comments",
      "issue_comment",
      """{ "action": "created", "comment": { "body": "LGTM", "created_at": "2012-12-14T08:44:55Z", "id": 11368980, "issue_url": "https://api.github.com/repos/akka/akka/issues/9141308", "updated_at": "2012-12-14T08:44:55Z", "url": "https://api.github.com/repos/akka/akka/issues/comments/11368980", "user": { "avatar_url": "https://secure.gravatar.com/avatar/262b1ab25e66b1e15a48fa3f68703aad?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/rkuhn/events{/privacy}", "followers_url": "https://api.github.com/users/rkuhn/followers", "following_url": "https://api.github.com/users/rkuhn/following", "gists_url": "https://api.github.com/users/rkuhn/gists{/gist_id}", "gravatar_id": "262b1ab25e66b1e15a48fa3f68703aad", "id": 470469, "login": "rkuhn", "organizations_url": "https://api.github.com/users/rkuhn/orgs", "received_events_url": "https://api.github.com/users/rkuhn/received_events", "repos_url": "https://api.github.com/users/rkuhn/repos", "starred_url": "https://api.github.com/users/rkuhn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkuhn/subscriptions", "type": "User", "url": "https://api.github.com/users/rkuhn" } }, "issue": { "assignee": null, "body": "* Note that ClusterRouterConfig is not changed, i.e. routees will be removed\n when unreachable\n* Routers that are not wrapped by ClusterRouterConfig will watch as usual, i.e.\n remove routees when Terminated, i.e. node down", "closed_at": null, "comments": 6, "comments_url": "https://api.github.com/repos/akka/akka/issues/938/comments", "created_at": "2012-12-10T14:15:34Z", "events_url": "https://api.github.com/repos/akka/akka/issues/938/events", "html_url": "https://github.com/akka/akka/issues/938", "id": 9141308, "labels": [], "labels_url": "https://api.github.com/repos/akka/akka/issues/938/labels{/name}", "milestone": null, "number": 938, "pull_request": { "diff_url": "https://github.com/akka/akka/pull/938.diff", "html_url": "https://github.com/akka/akka/pull/938", "patch_url": "https://github.com/akka/akka/pull/938.patch" }, "state": "open", "title": "Publish AddressTerminated after a node is Down, not when unreachable, see #2779", "updated_at": "2012-12-14T08:44:55Z", "url": "https://api.github.com/repos/akka/akka/issues/938", "user": { "avatar_url": "https://secure.gravatar.com/avatar/a036dbdf494ae4c9d46e1d24b53fd5da?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/patriknw/events{/privacy}", "followers_url": "https://api.github.com/users/patriknw/followers", "following_url": "https://api.github.com/users/patriknw/following", "gists_url": "https://api.github.com/users/patriknw/gists{/gist_id}", "gravatar_id": "a036dbdf494ae4c9d46e1d24b53fd5da", "id": 336161, "login": "patriknw", "organizations_url": "https://api.github.com/users/patriknw/orgs", "received_events_url": "https://api.github.com/users/patriknw/received_events", "repos_url": "https://api.github.com/users/patriknw/repos", "starred_url": "https://api.github.com/users/patriknw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/patriknw/subscriptions", "type": "User", "url": "https://api.github.com/users/patriknw" } }, "repository": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T21:19:21Z", "size": 15624, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-14T05:21:44Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1420, "watchers_count": 1420 }, "sender": { "avatar_url": "https://secure.gravatar.com/avatar/262b1ab25e66b1e15a48fa3f68703aad?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/rkuhn/events{/privacy}", "followers_url": "https://api.github.com/users/rkuhn/followers", "following_url": "https://api.github.com/users/rkuhn/following", "gists_url": "https://api.github.com/users/rkuhn/gists{/gist_id}", "gravatar_id": "262b1ab25e66b1e15a48fa3f68703aad", "id": 470469, "login": "rkuhn", "organizations_url": "https://api.github.com/users/rkuhn/orgs", "received_events_url": "https://api.github.com/users/rkuhn/received_events", "repos_url": "https://api.github.com/users/rkuhn/repos", "starred_url": "https://api.github.com/users/rkuhn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkuhn/subscriptions", "type": "User", "url": "https://api.github.com/users/rkuhn" } }""",
      equalTo(Right(Some(IssueCommentEvent("created", "938", true, "LGTM", "akka", "akka")))))
      // Enable once example of non-pull-request issue comment is available
//    jsonParsingExample(
//      "parse non-pull-request issue comment created event",
//      "issue_comment",
//      """{ "action": "created", "comment": { "body": "LGTM", "created_at": "2012-12-14T08:44:55Z", "id": 11368980, "issue_url": "https://api.github.com/repos/akka/akka/issues/9141308", "updated_at": "2012-12-14T08:44:55Z", "url": "https://api.github.com/repos/akka/akka/issues/comments/11368980", "user": { "avatar_url": "https://secure.gravatar.com/avatar/262b1ab25e66b1e15a48fa3f68703aad?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/rkuhn/events{/privacy}", "followers_url": "https://api.github.com/users/rkuhn/followers", "following_url": "https://api.github.com/users/rkuhn/following", "gists_url": "https://api.github.com/users/rkuhn/gists{/gist_id}", "gravatar_id": "262b1ab25e66b1e15a48fa3f68703aad", "id": 470469, "login": "rkuhn", "organizations_url": "https://api.github.com/users/rkuhn/orgs", "received_events_url": "https://api.github.com/users/rkuhn/received_events", "repos_url": "https://api.github.com/users/rkuhn/repos", "starred_url": "https://api.github.com/users/rkuhn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkuhn/subscriptions", "type": "User", "url": "https://api.github.com/users/rkuhn" } }, "issue": { "assignee": null, "body": "* Note that ClusterRouterConfig is not changed, i.e. routees will be removed\n when unreachable\n* Routers that are not wrapped by ClusterRouterConfig will watch as usual, i.e.\n remove routees when Terminated, i.e. node down", "closed_at": null, "comments": 6, "comments_url": "https://api.github.com/repos/akka/akka/issues/938/comments", "created_at": "2012-12-10T14:15:34Z", "events_url": "https://api.github.com/repos/akka/akka/issues/938/events", "html_url": "https://github.com/akka/akka/issues/938", "id": 9141308, "labels": [], "labels_url": "https://api.github.com/repos/akka/akka/issues/938/labels{/name}", "milestone": null, "number": 938, "pull_request": { "diff_url": "https://github.com/akka/akka/pull/938.diff", "html_url": "https://github.com/akka/akka/pull/938", "patch_url": "https://github.com/akka/akka/pull/938.patch" }, "state": "open", "title": "Publish AddressTerminated after a node is Down, not when unreachable, see #2779", "updated_at": "2012-12-14T08:44:55Z", "url": "https://api.github.com/repos/akka/akka/issues/938", "user": { "avatar_url": "https://secure.gravatar.com/avatar/a036dbdf494ae4c9d46e1d24b53fd5da?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/patriknw/events{/privacy}", "followers_url": "https://api.github.com/users/patriknw/followers", "following_url": "https://api.github.com/users/patriknw/following", "gists_url": "https://api.github.com/users/patriknw/gists{/gist_id}", "gravatar_id": "a036dbdf494ae4c9d46e1d24b53fd5da", "id": 336161, "login": "patriknw", "organizations_url": "https://api.github.com/users/patriknw/orgs", "received_events_url": "https://api.github.com/users/patriknw/received_events", "repos_url": "https://api.github.com/users/patriknw/repos", "starred_url": "https://api.github.com/users/patriknw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/patriknw/subscriptions", "type": "User", "url": "https://api.github.com/users/patriknw" } }, "repository": { "archive_url": "https://api.github.com/repos/akka/akka/{archive_format}{/ref}", "assignees_url": "https://api.github.com/repos/akka/akka/assignees{/user}", "blobs_url": "https://api.github.com/repos/akka/akka/git/blobs{/sha}", "branches_url": "https://api.github.com/repos/akka/akka/branches{/branch}", "clone_url": "https://github.com/akka/akka.git", "collaborators_url": "https://api.github.com/repos/akka/akka/collaborators{/collaborator}", "comments_url": "https://api.github.com/repos/akka/akka/comments{/number}", "commits_url": "https://api.github.com/repos/akka/akka/commits{/sha}", "compare_url": "https://api.github.com/repos/akka/akka/compare/{base}...{head}", "contents_url": "https://api.github.com/repos/akka/akka/contents/{+path}", "contributors_url": "https://api.github.com/repos/akka/akka/contributors", "created_at": "2009-02-16T12:51:54Z", "description": "Akka Project", "downloads_url": "https://api.github.com/repos/akka/akka/downloads", "events_url": "https://api.github.com/repos/akka/akka/events", "fork": false, "forks": 270, "forks_count": 270, "forks_url": "https://api.github.com/repos/akka/akka/forks", "full_name": "akka/akka", "git_commits_url": "https://api.github.com/repos/akka/akka/git/commits{/sha}", "git_refs_url": "https://api.github.com/repos/akka/akka/git/refs{/sha}", "git_tags_url": "https://api.github.com/repos/akka/akka/git/tags{/sha}", "git_url": "git://github.com/akka/akka.git", "has_downloads": true, "has_issues": false, "has_wiki": false, "homepage": "http://akka.io", "hooks_url": "https://api.github.com/repos/akka/akka/hooks", "html_url": "https://github.com/akka/akka", "id": 130013, "issue_comment_url": "https://api.github.com/repos/akka/akka/issues/comments/{number}", "issue_events_url": "https://api.github.com/repos/akka/akka/issues/events{/number}", "issues_url": "https://api.github.com/repos/akka/akka/issues{/number}", "keys_url": "https://api.github.com/repos/akka/akka/keys{/key_id}", "labels_url": "https://api.github.com/repos/akka/akka/labels{/name}", "language": "Scala", "languages_url": "https://api.github.com/repos/akka/akka/languages", "merges_url": "https://api.github.com/repos/akka/akka/merges", "milestones_url": "https://api.github.com/repos/akka/akka/milestones{/number}", "mirror_url": null, "name": "akka", "notifications_url": "https://api.github.com/repos/akka/akka/notifications{?since,all,participating}", "open_issues": 12, "open_issues_count": 12, "owner": { "avatar_url": "https://secure.gravatar.com/avatar/04189570a4df698616f57f8823e6bf9f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-org-420.png", "events_url": "https://api.github.com/users/akka/events{/privacy}", "followers_url": "https://api.github.com/users/akka/followers", "following_url": "https://api.github.com/users/akka/following", "gists_url": "https://api.github.com/users/akka/gists{/gist_id}", "gravatar_id": "04189570a4df698616f57f8823e6bf9f", "id": 1496237, "login": "akka", "organizations_url": "https://api.github.com/users/akka/orgs", "received_events_url": "https://api.github.com/users/akka/received_events", "repos_url": "https://api.github.com/users/akka/repos", "starred_url": "https://api.github.com/users/akka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akka/subscriptions", "type": "Organization", "url": "https://api.github.com/users/akka" }, "private": false, "pulls_url": "https://api.github.com/repos/akka/akka/pulls{/number}", "pushed_at": "2012-12-13T21:19:21Z", "size": 15624, "ssh_url": "git@github.com:akka/akka.git", "stargazers_url": "https://api.github.com/repos/akka/akka/stargazers", "statuses_url": "https://api.github.com/repos/akka/akka/statuses/{sha}", "subscribers_url": "https://api.github.com/repos/akka/akka/subscribers", "subscription_url": "https://api.github.com/repos/akka/akka/subscription", "svn_url": "https://github.com/akka/akka", "tags_url": "https://api.github.com/repos/akka/akka/tags{/tag}", "teams_url": "https://api.github.com/repos/akka/akka/teams", "trees_url": "https://api.github.com/repos/akka/akka/git/trees{/sha}", "updated_at": "2012-12-14T05:21:44Z", "url": "https://api.github.com/repos/akka/akka", "watchers": 1420, "watchers_count": 1420 }, "sender": { "avatar_url": "https://secure.gravatar.com/avatar/262b1ab25e66b1e15a48fa3f68703aad?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", "events_url": "https://api.github.com/users/rkuhn/events{/privacy}", "followers_url": "https://api.github.com/users/rkuhn/followers", "following_url": "https://api.github.com/users/rkuhn/following", "gists_url": "https://api.github.com/users/rkuhn/gists{/gist_id}", "gravatar_id": "262b1ab25e66b1e15a48fa3f68703aad", "id": 470469, "login": "rkuhn", "organizations_url": "https://api.github.com/users/rkuhn/orgs", "received_events_url": "https://api.github.com/users/rkuhn/received_events", "repos_url": "https://api.github.com/users/rkuhn/repos", "starred_url": "https://api.github.com/users/rkuhn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkuhn/subscriptions", "type": "User", "url": "https://api.github.com/users/rkuhn" } }""",
//      equalTo(Right(Some(IssueCommentEvent("created", "938", false, "LGTM", "akka", "akka")))))
  }

  def eventHandlingExample(exampleName: String, event: GithubEvent, expected: Option[HubActor.CheckPullRequest]): Example = {
    exampleName in {
      handlingForEvent(event) must equalTo(expected)
    }
  }

  "Github hook" should {
    eventHandlingExample(
      "send message when pull request opened",
      PullRequestEvent("opened", "589", "bob", "akka"),
      Some(HubActor.CheckPullRequest("bob", "akka", "589")))
    eventHandlingExample("send message when pull request synchronized",
      PullRequestEvent("synchronize", "589", "bob", "akka"),
      Some(HubActor.CheckPullRequest("bob", "akka", "589")))
    eventHandlingExample("not send message when pull request closed",
      PullRequestEvent("closed", "589", "bob", "akka"),
      None)
    eventHandlingExample("send message when PLS REBUILD pull request comment received",
      IssueCommentEvent("created", "941", true, "PLS REBUILD ALL\r\n", "bob", "akka"),
      Some(HubActor.CheckPullRequest("bob", "akka", "941")))
    eventHandlingExample("not send message when general pull request comment received",
      IssueCommentEvent("created", "941", true, "hello\r\n", "bob", "akka"),
      None)
    eventHandlingExample("not send message when issue comment received",
      IssueCommentEvent("created", "941", false, "PLS REBUILD ALL\r\n", "bob", "akka"),
      None)
  }

//  def eventHandlingExampleXXX(exampleName: String, event: Event)(check: Result=>Unit): Example = {
//    exampleName in new AkkaTestkitSpecs2Support {
//      val github = new Github(testActor)
//      within(10 seconds) {
//        val result = github.index(FakeRequest(
//          "POST",
//          "/hook/github",
//          FakeHeaders(),
//          event,
//          "127.0.0.1"))
//        check(result)
//      }
//    }
//  }
}